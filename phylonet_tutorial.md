# Phylonet tutorial

## Installation
Donwload binary jar file from [here](https://bioinfocs.rice.edu/phylonet)

Also need to install Beagle, I followed this [link](https://github.com/beagle-dev/beagle-lib/wiki/LinuxInstallInstructions)

Everytime before I run Phylonet, I have to run on the terminal this:
```bash
export LD_LIBRARY_PATH=$HOME/lib:$LD_LIBRARY_PATH
export PKG_CONFIG_PATH=$HOME/lib/pkgconfig:$PKG_CONFIG_PATH
```

### Run the script
```bash
java -jar PhyloNet_3.8.2.jar MCMCseq_exampleSu.nex
```
### Output
can be read by this link
https://icytree.org/

#### Get Tracer readable files
Convert the log file generated by our MCMC sampling method to be readable by Tracer

```bash
SummarizeMCMCResults -mode "Tracer" [-cl chainLength] [-bl burnInLength] [-sf sampleFrequency] [-outfile filename] [-truenet networkString] 
```
SummarizeMCMCResults -mode "Tracer" -cl 250000  -bl 50000 -sf 5000 -outfile test -truenet networkString

## Input file
### MCMC_SEQ


```bash
## end of NEXUS file
BEGIN PHYLONET;  
MCMC_SEQ -loci (YL053W,YAL0532,YAL03W3,YAL03W4,YAL3W5) -cl 250000 -bl 50000 -sf 5000 -tm <BRAU:brau_1____,brau_2____; CHLO:chlo_1____,chlo_2____; CLAR:clar_1____,clar_2____; DEFI:defi_1____,defi_2____; DER:der_1_____; MIX1:mix1_1____,mix1_2____; PAR:mix2_1____,mix2_2____,par_1_____,par_2_____,par12738_1; POR:por1_1____,por1_2____,por2_1____,por2_2____; PRAB:praB_1____,praB_2____; PRAC:praC_1____,praC_2____; RAD:rad1_1____,rad1_2____,rad2_1____,rad2_2____; RUD: rud1_1____,rud1_2____,rud2_1____,rud2_2____; SAX: sax_1_____,sax_2_____; STEI:stei_1____,stei_2____; VAL:val_1_____,val_2_____>;
END;
```


Mapping individuals to species:
```bash
-tm <SPS1:ind1,ind2; SPS2:ind3,ind4>
```

Removing space from end of line>
```bash
sed -i 's/ *$//' file
# in case of one word long lines:
tr -s " " < file
```

java -jar ./PhyloNet_3.8.2.jar tracer.nex

export LD_LIBRARY_PATH=$HOME/lib:$LD_LIBRARY_PATH
export PKG_CONFIG_PATH=$HOME/lib/pkgconfig:$PKG_CONFIG_PATH
java -jar PhyloNet_3.8.2.jar MCMCseq_exampleSu.nex


Tutorials:
https://tandy.cs.illinois.edu/nakhleh-montpellier.pdf
